---
# Cleanup Talos VMs on failure
# This task file is called when any step in the Talos cluster setup fails

- name: Display cleanup warning
  ansible.builtin.debug:
    msg: |
      ⚠️  Talos cluster setup failed!

      You can retry the setup without destroying VMs by running:
        bash deploy-homelab.sh --skip-layer1

      Or destroy Talos VMs and redeploy
        bash deploy-homelab.sh --destroy-homelab
        bash deploy-homelab.sh

- name: Display cleanup result
  ansible.builtin.debug:
    msg: |
      ℹ️  Cleanup skipped - Talos VMs and configs preserved for retry