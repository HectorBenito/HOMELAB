---
# Wait for Talos nodes to be reachable

- name: Wait for control plane nodes to be reachable
  ansible.builtin.wait_for:
    host: "{{ item.ip }}"
    port: 50000 # Talos API port
    timeout: 300
    msg: "Control plane {{ item.ip }} is not reachable"
  loop: "{{ talos_nodes.control_planes }}"

- name: Wait for worker nodes to be reachable
  ansible.builtin.wait_for:
    host: "{{ item.ip }}"
    port: 50000
    timeout: 300
    msg: "Worker {{ item.ip }} is not reachable"
  loop: "{{ talos_nodes.workers }}"

- name: Display node readiness
  ansible.builtin.debug:
    msg: "âœ“ All Talos nodes are reachable"