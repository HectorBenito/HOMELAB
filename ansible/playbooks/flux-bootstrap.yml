---
# Setup FluxCD and SOPS in a Kubernetes cluster

- name: Bootstrap FluxCD in Kubernetes
  hosts: localhost
  connection: local
  gather_facts: true

  tasks:
    - name: Check prerequisites
      ansible.builtin.include_role:
        name: fluxcd
        tasks_from: configure-flux.yml

    - name: Wait for Talos nodes
      ansible.builtin.include_role:
        name: fluxcd
        tasks_from: configure-sops.yml
