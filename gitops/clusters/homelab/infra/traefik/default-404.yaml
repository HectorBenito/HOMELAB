apiVersion: v1
kind: ConfigMap
metadata:
  name: default-404-html
  namespace: traefik
data:
  index.html: |
    <!doctype html>
    <html lang="es">
    <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <title>404 — No encontrado</title>
      <style>
        :root { color-scheme: dark light; }
        body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;min-height:100vh;display:grid;place-items:center;background:radial-gradient(1200px 600px at 20% 20%, rgba(99,102,241,.18), transparent 60%),radial-gradient(1000px 500px at 80% 30%, rgba(16,185,129,.16), transparent 55%),radial-gradient(800px 400px at 50% 90%, rgba(236,72,153,.14), transparent 55%),#0b1020;color:#e5e7eb}
        .card{width:min(720px,calc(100% - 2rem));background:rgba(17,24,39,.6);border:1px solid rgba(255,255,255,.08);border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,.35);padding:28px;backdrop-filter:blur(10px)}
        .row{display:grid;grid-template-columns:1fr;gap:14px}
        @media (min-width:720px){.row{grid-template-columns:1fr auto;align-items:center}}
        .code{font-size:56px;font-weight:800;letter-spacing:-0.04em;margin:0;line-height:1}
        .title{margin:6px 0 0;font-size:20px;font-weight:700}
        .muted{margin:10px 0 0;color:rgba(229,231,235,.75);line-height:1.5}
        .pill{display:inline-flex;gap:10px;align-items:center;padding:10px 12px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.06);font-size:13px;color:rgba(229,231,235,.85);overflow-wrap:anywhere}
        .btns{display:flex;flex-wrap:wrap;gap:10px;margin-top:18px}
        a.btn{text-decoration:none;padding:10px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.06);color:#e5e7eb;font-weight:600;font-size:14px}
        a.btn:hover{background:rgba(255,255,255,.10)}
        .footer{margin-top:18px;font-size:12px;color:rgba(229,231,235,.55)}
      </style>
    </head>
    <body>
      <main class="card">
        <div class="row">
          <div>
            <p class="code">404</p>
            <p class="title">No hay nada que ver por aqui...</p>
          </div>
          <div class="pill" id="meta">host=… · path=…</div>
        </div>
        <div class="footer">nasbenito · default route</div>
      </main>
      <script>
        document.getElementById("meta").textContent =
          `host=${location.host||"-"} · path=${location.pathname||"/"}`;
      </script>
    </body>
    </html>
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: default-404
  namespace: traefik
spec:
  replicas: 3
  selector:
    matchLabels:
      app: default-404
  template:
    metadata:
      labels:
        app: default-404
    spec:
      securityContext:
        runAsNonRoot: true
        seccompProfile:
          type: RuntimeDefault
      containers:
        - name: nginx
          image: nginx:1.27-alpine
          ports:
            - containerPort: 80
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop: ["ALL"]
            runAsNonRoot: true
            runAsUser: 101
            runAsGroup: 101
            readOnlyRootFilesystem: true
          volumeMounts:
            - name: html
              mountPath: /usr/share/nginx/html
              readOnly: true
            - name: cache
              mountPath: /var/cache/nginx
            - name: run
              mountPath: /var/run
            - name: tmp
              mountPath: /tmp
      volumes:
        - name: html
          configMap:
            name: default-404-html
        - name: cache
          emptyDir: {}
        - name: run
          emptyDir: {}
        - name: tmp
          emptyDir: {}
---
apiVersion: v1
kind: Service
metadata:
  name: default-404
  namespace: traefik
spec:
  selector:
    app: default-404
  ports:
    - name: http
      port: 80
      targetPort: 8080
