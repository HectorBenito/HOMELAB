apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - helmrepository.yaml
  - authentik-values.secret.sops.yaml
  - authentik-config.secret.sops.yaml
  - helmrelease.yaml
  - ingress.yaml

patches:
  - path: patch-deployments-servers.yaml
    target:
      kind: Deployment
      name: authentik-server
      namespace: authentik

    - path: patch-deployments-workers.yaml
    target:
      kind: Deployment
      name: authentik-worker
      namespace: authentik